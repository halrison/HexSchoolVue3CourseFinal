import{m as V,a as L,s as I,o as D,O as T,G as z,r as w,d as h,e as y,h as e,f as a,w as R,t as b,g as o,n as _,W as G,X as Q,Y as W,q as x,v as O,C as S,F as M,i as B,S as q,x as X,u as Y,c as E,Q as F}from"./index-76d5b82d.js";import{_ as j}from"./PaginationBar-07a76f54.js";import{_ as A}from"./RemoveModal-8875dbfd.js";import"./coupons-3eb6210c.js";import"./articles-c7527420.js";const H={class:"modal-dialog modal-xl",role:"dialog"},J={class:"modal-header bg-dark text-white"},K={class:"modal-title",id:"exampleModalLabel"},Z={class:"modal-body"},ee={class:"row"},te={class:"col-sm-4"},le=e("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),oe=e("br",null,null,-1),se={class:"mb-3 input-group"},ae=["disabled"],ne={class:"mb-3"},ie=e("label",{for:"input",class:"form-label"},"或上傳圖片",-1),de={class:"mt-5 mb-3 input-group"},re={class:"mb-3 input-group"},ce=["value"],ue=["value"],me=["onClick"],pe={class:"col-sm-8"},_e={class:"mb-3"},be=e("label",{for:"title",class:"form-label"},"標題",-1),fe={class:"row gx-2"},ve={class:"mb-3 col-md-6"},ge=e("label",{for:"category",class:"form-label"},"分類",-1),he={class:"mb-3 col-md-6"},ye=e("label",{for:"price",class:"form-label"},"單位",-1),ke={class:"row gx-2"},xe={class:"mb-3 col-md-6"},Ve=e("label",{for:"origin_price",class:"form-label"},"原價",-1),Ce={class:"mb-3 col-md-6"},Ue=e("label",{for:"price",class:"form-label"},"售價",-1),we=e("hr",null,null,-1),$e={class:"mb-3"},Me=e("label",{for:"description",class:"form-label"},"產品描述",-1),Pe={class:"mb-3"},Se=e("label",{for:"content",class:"form-label"},"說明內容",-1),qe={class:"mb-3"},Ee={class:"form-check"},Fe=e("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),Le=e("div",{class:"modal-footer"},[e("button",{type:"submit",class:"btn btn-primary"},"確認"),e("button",{type:"reset",class:"btn btn-danger"},"取消 ")],-1),Ie={__name:"ProductModal",props:["product"],setup(P,{expose:$}){const i=V(""),k=V(null),C=P,t=L(),{product:r}=I(t);let f;D(function(){f=new T(k.value)}),z(()=>C.product,async function(n){r.value=n,r.value.id&&t.getProduct(r.value.id)}),$({show:d});function v(n){var l;t.product.imageUrl?((l=t.product).imagesUrl||(l.imagesUrl=[]),t.product.imagesUrl.push(n)):t.product.imageUrl=n,i.value=""}function U(){t.product.id?t.editProduct():t.addProduct(),g()}function d(){f.show()}function g(){f.hide(),t.getProducts(1,"admin")}return(n,l)=>{const c=w("FieldC"),u=w("ErrorMessage"),N=w("FormC");return h(),y("div",{class:"modal fade",tabindex:"-1",ref_key:"DOM",ref:k},[e("div",H,[a(N,{class:"modal-content border-0",onSubmit:U,onReset:g},{default:R(({errors:m})=>[e("div",J,[e("h5",K,[e("span",null,b(o(t).product.id?"變更":"新增")+"產品",1)])]),e("div",Z,[e("div",ee,[e("div",te,[e("div",null,[le,oe,e("p",se,[a(c,{label:"圖片網址",name:"url",rules:"url",type:"text",class:_(["form-control",{"is-invalid":m.url}]),id:"image","aria-describedby":"addImage",placeholder:"請輸入圖片連結",modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=s=>i.value=s),standalone:!0},null,8,["modelValue","class"]),e("button",{id:"addImage",type:"button",class:"btn btn-outline-primary btn-sm",onClick:l[1]||(l[1]=s=>o(G)(i.value,p=>v(p))),disabled:!i.value}," 新增圖片 ",8,ae)]),a(u,{class:"invalid-feedback",name:"url"})]),e("div",ne,[ie,a(c,{class:"form-control",name:"file",type:"file",rules:"image",label:"選取檔案",onChange:l[2]||(l[2]=s=>o(Q)(s.target.files,p=>v(p))),standalone:!0}),a(u,{name:"file",class:"invalid-feedback",style:W({display:m.file?"block":"none"})},null,8,["style"])]),e("div",de,[x(e("div",re,[S(" 主圖片 "),e("input",{type:"url",class:"form-control",readonly:"",placeholder:"請輸入連結",value:o(t).product.imageUrl},null,8,ce),e("button",{type:"button",class:"btn btn-outline-danger",onClick:l[3]||(l[3]=s=>delete o(t).product.imageUrl)}," 移除 ")],512),[[O,o(t).product.imageUrl]]),(h(!0),y(M,null,B(o(t).product.imagesUrl,(s,p)=>(h(),y("div",{class:"mb-3 input-group",key:p},[S(" 副圖片"+b(p+1)+" ",1),e("input",{type:"url",class:"form-control",readonly:"",placeholder:"請輸入連結",value:s},null,8,ue),e("button",{type:"button",class:"btn btn-outline-danger",onClick:Ge=>o(t).product.imagesUrl.splice(p,1)}," 移除 ",8,me)]))),128))])]),e("div",pe,[e("div",_e,[be,a(c,{type:"text",class:_(["form-control",{"is-invalid":m.title}]),id:"title",label:"標題",name:"title",rules:"required",placeholder:"請輸入標題",modelValue:o(t).product.title,"onUpdate:modelValue":l[4]||(l[4]=s=>o(t).product.title=s)},null,8,["modelValue","class"]),a(u,{class:"invalid-feedback",name:"title"})]),e("div",fe,[e("div",ve,[ge,a(c,{type:"text",class:_(["form-control",{"is-invalid":m.category}]),id:"category",rules:"required",placeholder:"請輸入分類",label:"分類",name:"category",modelValue:o(t).product.category,"onUpdate:modelValue":l[5]||(l[5]=s=>o(t).product.category=s)},null,8,["modelValue","class"]),a(u,{class:"invalid-feedback",name:"category"})]),e("div",he,[ye,a(c,{type:"text",class:_(["form-control",{"is-invalid":m.unit}]),id:"unit",label:"單位",name:"unit",rules:"required",placeholder:"請輸入單位",modelValue:o(t).product.unit,"onUpdate:modelValue":l[6]||(l[6]=s=>o(t).product.unit=s)},null,8,["modelValue","class"]),a(u,{class:"invalid-feedback",name:"unit"})])]),e("div",ke,[e("div",xe,[Ve,a(c,{type:"number",class:_(["form-control",{"is-invalid":m.origin_price}]),id:"origin_price",min:"1",rules:"required|integer",placeholder:"請輸入原價",label:"原價",name:"origin_price",modelValue:o(t).product.origin_price,"onUpdate:modelValue":l[7]||(l[7]=s=>o(t).product.origin_price=s)},null,8,["modelValue","class"]),a(u,{class:"invalid-feedback",name:"origin_price"})]),e("div",Ce,[Ue,a(c,{type:"number",class:_(["form-control",{"is-invalid":m.price}]),id:"price",min:"1",label:"售價",name:"price",rules:"required|integer",placeholder:"請輸入售價",modelValue:o(t).product.price,"onUpdate:modelValue":l[8]||(l[8]=s=>o(t).product.price=s),max:o(t).product.price},null,8,["modelValue","max","class"]),a(u,{class:"invalid-feedback",name:"price"})])]),we,e("div",$e,[Me,x(e("textarea",{type:"text",class:"form-control",id:"description",placeholder:"請輸入產品描述","onUpdate:modelValue":l[9]||(l[9]=s=>o(t).product.description=s)},null,512),[[q,o(t).product.description]])]),e("div",Pe,[Se,x(e("textarea",{type:"text",class:"form-control",id:"content",placeholder:"請輸入產品說明內容","onUpdate:modelValue":l[10]||(l[10]=s=>o(t).product.content=s)},null,512),[[q,o(t).product.content]])]),e("div",qe,[e("div",Ee,[x(e("input",{class:"form-check-input",type:"checkbox",id:"is_enabled","onUpdate:modelValue":l[11]||(l[11]=s=>o(t).product.is_enabled=s),"true-value":1,"false-value":0},null,512),[[X,o(t).product.is_enabled]]),Fe])])])])]),Le]),_:1})])],512)}}},De={class:"table mt-4"},Oe=e("thead",null,[e("tr",null,[e("th",null,"分類"),e("th",null,"產品名稱"),e("th",{class:"text-end"},"原價"),e("th",{class:"text-end"},"售價"),e("th",{class:"text-center"},"是否啟用"),e("th",null,"編輯")])],-1),Be={class:"text-end"},Ne={class:"text-end"},Te={class:"btn-group"},ze=["onClick"],Re=["onClick"],Ae={__name:"ProductManage",setup(P){const{isLoading:$}=I(Y()),i=L(),k=E(()=>i.products),C=E(()=>i.pagination),t=V({}),r=V(null),f=V(null);D(async function(){await i.getProducts(1,"admin")});async function v(U,d=""){switch(t.value=k.value.find(g=>g.id===d)||{},U){case"add":r.value.show();break;case"modify":r.value.show();break;case"remove":f.value.show();break}}return(U,d)=>{const g=w("LoadingC");return h(),y(M,null,[a(g,{"is-full-page":!0,active:o($)},null,8,["active"]),e("button",{type:"button",class:"btn btn-primary float-end",onClick:d[0]||(d[0]=n=>v("add"))},"新增商品"),e("table",De,[Oe,e("tbody",null,[(h(!0),y(M,null,B(k.value,n=>(h(),y("tr",{key:n.id},[e("td",null,b(n.category),1),e("td",null,b(n.title),1),e("td",Be,b(o(F)(n.origin_price)),1),e("td",Ne,b(o(F)(n.price)),1),e("td",{class:_([n.is_enabled===1?"text-success":"text-danger","text-center"])},[e("span",null,b(n.is_enabled===1?"啟":"停")+"用",1)],2),e("td",null,[e("div",Te,[e("button",{onClick:l=>v("modify",n.id),class:"btn btn-outline-primary btn-sm"},"編輯",8,ze),e("button",{onClick:l=>v("remove",n.id),class:"btn btn-outline-danger btn-sm"},"移除",8,Re)])])]))),128))])]),x(a(j,{pagination:C.value,onPaginate:d[1]||(d[1]=n=>o(i).getProducts(n,"admin"))},null,8,["pagination"]),[[O,C.value.total_pages>1]]),a(Ie,{product:t.value,ref_key:"addEditModal",ref:r},null,8,["product"]),a(A,{item:t.value,type:"產品",ref_key:"removeModal",ref:f},null,8,["item"])],64)}}};export{Ae as default};
