import{_ as O,a as U,s as h,u as F,b as M,B as T,y as V,m as S,o as j,r as E,d as c,e as n,f as m,g as e,h as t,w as J,t as l,F as f,C as d,i as R,n as z,p as A,j as G}from"./index-76d5b82d.js";import{a as H,_ as K}from"./CarouselComponent-775c89be.js";import"./ProductCard-eef6ce93.js";const i=u=>(A("data-v-54168b9d"),u=u(),G(),u),Q={class:"container mt-1"},W={class:"row justify-content-center"},X={class:"col figure"},Y=["src"],Z={class:"col"},tt={class:"row mt-1","aria-label":"breadcrumb"},st={class:"breadcrumb"},et=i(()=>t("li",{class:"breadcrumb-item"},"所有商品",-1)),ot={class:"breadcrumb-item active","aria-current":"page"},at={class:"fw-bold h1 mb-1"},it={class:"row"},ct={class:"col-6"},nt={class:"mb-0 text-muted text-end"},lt={class:"fw-bold text-end"},rt={key:1},dt={class:"col-6"},ut=i(()=>t("i",{class:"fa-solid fa-heart border-0"},null,-1)),_t=i(()=>t("i",{class:"fa-regular fa-heart border-0"},null,-1)),pt={class:"row align-items-center"},bt={class:"col-6"},vt={class:"input-group my-3 bg-light rounded"},ht={class:"input-group-prepend"},mt=i(()=>t("i",{class:"bi bi-dash"},null,-1)),ft=[mt],gt=["value"],yt={class:"input-group-append"},wt=i(()=>t("i",{class:"bi-plus bi"},null,-1)),xt=[wt],St={class:"col-6"},kt=i(()=>t("i",{class:"bi bi-cart-plus"},null,-1)),Ct={class:"row my-5"},Pt={class:"col border-end"},$t=i(()=>t("h3",{class:"text-center"},"商品描述",-1)),It={class:"col"},Lt=i(()=>t("h3",{class:"text-center"},"商品說明",-1)),Nt=i(()=>t("h3",{class:"text-center"},"更多商品",-1)),qt={__name:"ProductDetail",emits:["cart"],setup(u,{emit:Bt}){const g=U(),{getProduct:k,getProducts:C}=g,{product:s,products:P}=h(g),{isLoading:$}=h(F()),{pushMessage:_}=M(),y=T(),{addCart:I,getCarts:L}=y,{cartList:N}=h(y),v=V(),p=S(!1),b=S(1);j(async function(){Promise.all([k(v.query.id),C(1,"customer"),L()]).then(function(){p.value=localStorage.hasOwn("favorite")&&localStorage.getItem("favorite").includes(v.query.id)}).catch(function(o){_("info","",o)})});function w(){p.value=!p.value;let o=localStorage.hasOwn("favorite")?JSON.parse(localStorage.getItem("favorite")):[];o.includes(s.value.id)?(o=o.filter(a=>a!==s.value.id),_("success","移除最愛成功",`已將${s.value.title}移除最愛`)):(o=o.concat(s.value.id),_("success","加入最愛成功",`已將${s.value.title}加入最愛`)),localStorage.setItem("favorite",JSON.stringify(o))}async function q(){var o;(o=N.value)!=null&&o.find(a=>a.product_id===s.value.id)?_("info","重複加入商品",`商品${s.value.title}已位於購物車中`):await I(b.value)}return(o,a)=>{const B=E("LoadingC");return c(),n(f,null,[m(B,{active:e($),"is-full-page":!0},null,8,["active"]),t("div",Q,[t("div",W,[t("figure",X,[m(H,{items:e(s).imagesUrl?[e(s).imageUrl,...e(s).imagesUrl]:[e(s).imageUrl]},{default:J(({items:r})=>[(c(!0),n(f,null,R(r,(D,x)=>(c(),n("div",{class:z(["ratio ratio-1x1 carousel-item",{active:x===0}]),key:x},[t("img",{src:D,class:"d-block img-fluid"},null,8,Y)],2))),128))]),_:1},8,["items"])]),t("div",Z,[t("nav",tt,[t("ol",st,[et,t("li",ot,l(e(s).category),1)])]),t("h2",at,l(e(s).title),1),t("div",it,[t("div",ct,[e(s).price?(c(),n(f,{key:0},[t("p",nt,[d(" 原價"),t("del",null,l(e(s).origin_price),1),d(" 元 ")]),t("h4",lt,"現在只要 "+l(e(s).price)+" 元",1)],64)):(c(),n("h4",rt,l(e(s).price)+" 元",1))]),t("div",dt,[p.value?(c(),n("button",{key:0,class:"btn btn-secondary input-group-prepend w-100 py-2",onClick:w},[ut,d("移除最愛 ")])):(c(),n("button",{key:1,class:"btn btn-outline-secondary input-group-prepend w-100 py-2",onClick:w},[_t,d("加入最愛 ")]))])]),t("div",pt,[t("div",bt,[t("div",vt,[t("div",ht,[t("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",onClick:a[0]||(a[0]=r=>b.value--)},ft)]),t("input",{type:"text",class:"form-control border-0 text-center my-auto shadow-none bg-light","aria-label":"Example text with button addon","aria-describedby":"button-addon1",value:b.value},null,8,gt),t("div",yt,[t("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",onClick:a[1]||(a[1]=r=>b.value++)},xt)])])]),t("div",St,[t("button",{type:"button",class:"text-nowrap btn btn-dark w-100 py-2",onClick:a[2]||(a[2]=r=>q(e(s).id))},[kt,d("加到購物車 ")])])])])]),t("div",Ct,[t("div",Pt,[$t,t("p",null,l(e(s).description),1)]),t("div",It,[Lt,t("p",null,l(e(s).content),1)])]),Nt,m(K,{class:"mb-1",products:e(P).filter(r=>r.id!==e(v).query.id)},null,8,["products"])])],64)}}},Ft=O(qt,[["__scopeId","data-v-54168b9d"]]);export{Ft as default};
